<!doctype html>
<html lang="en">

<head>
	<title>parascene - auth</title>
	<link rel="stylesheet" href="/pages/auth.css" />
</head>

<body>
	<main>
		<div class="auth-logo">
			<a href="/" class="auth-logo-link">
				<svg class="logo" width="300" height="60" viewBox="0 0 185 40">
					<text x="1" y="30" class="logo-text">
						<tspan opacity="1">par</tspan>
						<tspan opacity="0.7" dx="-7">asc</tspan>
						<tspan opacity="1" dx="-7">ene</tspan>
					</text>
				</svg>
			</a>
		</div>

		<section id="signup">
			<form action="/signup" method="post" autocomplete="on">
				<input type="hidden" name="returnUrl" value="/" data-return-url />
				<label>
					Email
					<input type="email" name="username" autocomplete="username" inputmode="email" required />
				</label>
				<label>
					Password
					<input type="password" name="password" autocomplete="new-password" required />
				</label>
				<button type="submit">Create account</button>
			</form>
			<br />
			<p>Already have an account? <a href="#login">Login</a></p>
		</section>

		<section id="login">
			<div id="fail" class="alert error margin-bottom-1">
				<strong>Login failed</strong>
				<p>Please check your email and password, then try again.</p>
			</div>
			<form action="/login" method="post" autocomplete="on">
				<input type="hidden" name="returnUrl" value="/" data-return-url />
				<label>
					Email
					<input type="email" name="username" autocomplete="username" inputmode="email" required />
				</label>
				<label>
					Password
					<input type="password" name="password" autocomplete="current-password" required />
				</label>
				<button type="submit">Login</button>
			</form>
			<br />
			<p>Don't have an account? <a href="#signup">Signup</a></p>
		</section>

	</main>

	<script>
		(function () {
			try {
				var params = new URLSearchParams(window.location.search || '');
				var returnUrl = params.get('returnUrl');
				if (!returnUrl) return;

				// Basic client-side hardening; server still validates.
				if (typeof returnUrl !== 'string') return;
				returnUrl = returnUrl.trim();
				if (!returnUrl.startsWith('/') || returnUrl.startsWith('//') || returnUrl.indexOf('://') !== -1) {
					return;
				}
				if (returnUrl.length > 2048) return;

				var inputs = document.querySelectorAll('input[data-return-url][name="returnUrl"]');
				inputs.forEach(function (el) {
					el.value = returnUrl;
				});
			} catch (e) {
				// ignore
			}
		})();
	</script>

</body>

</html>